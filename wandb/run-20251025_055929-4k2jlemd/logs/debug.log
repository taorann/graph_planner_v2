2025-10-25 05:59:29,639 INFO    MainThread:1675627 [wandb_setup.py:_flush():80] Current SDK version is 0.21.1
2025-10-25 05:59:29,639 INFO    MainThread:1675627 [wandb_setup.py:_flush():80] Configure stats pid to 1675627
2025-10-25 05:59:29,639 INFO    MainThread:1675627 [wandb_setup.py:_flush():80] Loading settings from /root/.config/wandb/settings
2025-10-25 05:59:29,639 INFO    MainThread:1675627 [wandb_setup.py:_flush():80] Loading settings from /map-vepfs/taoran/graph_planner/wandb/settings
2025-10-25 05:59:29,639 INFO    MainThread:1675627 [wandb_setup.py:_flush():80] Loading settings from environment variables
2025-10-25 05:59:29,639 INFO    MainThread:1675627 [wandb_init.py:setup_run_log_directory():703] Logging user logs to /map-vepfs/taoran/graph_planner/wandb/run-20251025_055929-4k2jlemd/logs/debug.log
2025-10-25 05:59:29,639 INFO    MainThread:1675627 [wandb_init.py:setup_run_log_directory():704] Logging internal logs to /map-vepfs/taoran/graph_planner/wandb/run-20251025_055929-4k2jlemd/logs/debug-internal.log
2025-10-25 05:59:29,640 INFO    MainThread:1675627 [wandb_init.py:init():830] calling init triggers
2025-10-25 05:59:29,640 INFO    MainThread:1675627 [wandb_init.py:init():835] wandb.init called with sweep_config: {}
config: {'_wandb': {}}
2025-10-25 05:59:29,640 INFO    MainThread:1675627 [wandb_init.py:init():871] starting backend
2025-10-25 05:59:29,871 INFO    MainThread:1675627 [wandb_init.py:init():874] sending inform_init request
2025-10-25 05:59:29,942 INFO    MainThread:1675627 [wandb_init.py:init():882] backend started and connected
2025-10-25 05:59:29,944 INFO    MainThread:1675627 [wandb_init.py:init():953] updated telemetry
2025-10-25 05:59:29,949 INFO    MainThread:1675627 [wandb_init.py:init():977] communicating run to backend with 90.0 second timeout
2025-10-25 05:59:33,349 INFO    MainThread:1675627 [wandb_init.py:init():1029] starting run threads in backend
2025-10-25 05:59:34,190 INFO    MainThread:1675627 [wandb_run.py:_console_start():2494] atexit reg
2025-10-25 05:59:34,190 INFO    MainThread:1675627 [wandb_run.py:_redirect():2342] redirect: wrap_raw
2025-10-25 05:59:34,190 INFO    MainThread:1675627 [wandb_run.py:_redirect():2411] Wrapping output streams.
2025-10-25 05:59:34,191 INFO    MainThread:1675627 [wandb_run.py:_redirect():2434] Redirects installed.
2025-10-25 05:59:34,196 INFO    MainThread:1675627 [wandb_init.py:init():1075] run started, returning control to user process
2025-10-25 05:59:34,197 INFO    MainThread:1675627 [wandb_run.py:_config_callback():1380] config_cb None None {'experiment': {'name': 'test4g', 'seed': 1234, 'notes': 'Planner GRPO with 4 GPUs'}, 'paths': {'dataset_train': '/map-vepfs/taoran/graph_planner/datasets/swebench/test.jsonl', 'dataset_val': 'datasets/r2e_gym/val.jsonl', 'planner_model': 'models/qwen3-14b', 'planner_tokenizer': None, 'cgm_model': '/map-vepfs/taoran/CodeFuse-CGM/infra_model', 'cgm_tokenizer': None}, 'backends': {'planner_backend': 'local', 'cgm_backend': 'local', 'dtype': 'bfloat16', 'device_map_planner': [4, 5], 'device_map_cgm': [6, 7], 'max_gpu_memory': None}, 'planner_sampling': {'temperature': 0.2, 'top_p': 0.95, 'top_k': 50, 'max_new_tokens': 512, 'repetition_penalty': 1.0, 'do_sample': False, 'stop_on_invalid_json': True, 'stop': [], 'stop_ids': [], 'max_input_tokens': 4096}, 'cgm_generation': {'temperature': 0.2, 'top_p': 0.9, 'top_k': 40, 'max_new_tokens': 1024, 'num_return_sequences': 1, 'do_sample': False}, 'training': {'total_epochs': 1, 'train_batch_size': 4, 'grad_accum_steps': 8, 'precision': 'bf16', 'lr': 3e-05, 'weight_decay': 0.01, 'warmup_steps': 200, 'gradient_checkpointing': True, 'clip_grad_norm': 1.0, 'kl_coef': 0.1, 'entropy_coef': 0.01, 'value_coef': 1.0, 'clip_coef': 0.2, 'target_kl': 0.15, 'total_steps': None, 'resume_from': None}, 'env': {'max_steps': 6, 'reward_scale': 1.0, 'failure_penalty': -1.0, 'step_penalty': -0.05, 'timeout_penalty': -0.5, 'repo_op_limit': 64, 'disable_cgm_synthesis': False, 'apply_patches': True, 'docker_manifest': '/map-vepfs/taoran/graph_planner/datasets/swebench/docker_images_validation.txt', 'prepull_containers': False, 'prepull_max_workers': None, 'prepull_retries': None, 'prepull_delay': None, 'prepull_timeout': None}, 'parallel': {'tensor_parallel_planner': 2, 'tensor_parallel_cgm': 2, 'replicas': 1, 'parallel_agents': 2, 'rollout_workers': 2, 'workflow_parallel': 2}, 'resources': {'num_gpus': 4, 'num_nodes': 1, 'ray_num_gpus': 4, 'ray_num_cpus': 16, 'ray_memory': None, 'ray_object_store_memory': None}, 'logging': {'wandb': {'enabled': True, 'offline': False, 'project': 'graph-planner', 'entity': None, 'run_name': 'test4g', 'watch': {'enabled': True, 'log': 'gradients', 'log_freq': 200}}, 'log_backend': 'wandb', 'output_dir': 'outputs', 'save_interval': 500, 'eval_interval': 500, 'resolved_run_dir': '/map-vepfs/taoran/graph_planner/outputs/test4g', 'resolved_config_path': '/map-vepfs/taoran/graph_planner/outputs/test4g/resolved_config.yaml'}, 'telemetry': {'log_gpu': True, 'log_ray': True, 'log_patch_stats': True, 'log_planner_parse_errors': True, 'log_cgm_errors': True}, 'verl_overrides': {'trainer': {'n_gpus_per_node': 4, 'gradient_accumulation_steps': 4}}}
2025-10-25 05:59:34,199 INFO    MainThread:1675627 [wandb_watch.py:_watch():68] Watching
2025-10-25 06:00:01,517 INFO    MsgRouterThr:1675627 [mailbox.py:close():129] [no run ID] Closing mailbox, abandoning 1 handles.
2025-10-25 06:00:04,330 ERROR   MainThread:1675627 [redirect.py:_on_write():664] [all runs] error in stdout callback
Traceback (most recent call last):
  File "/map-vepfs/taoran/envs/taoran/lib/python3.10/site-packages/wandb/sdk/lib/redirect.py", line 662, in _on_write
    cb(written_data)
  File "/map-vepfs/taoran/envs/taoran/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 2415, in <lambda>
    lambda data: self._console_raw_callback("stdout", data),
  File "/map-vepfs/taoran/envs/taoran/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 399, in wrapper
    return func(self, *args, **kwargs)
  File "/map-vepfs/taoran/envs/taoran/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 457, in wrapper_fn
    return func(self, *args, **kwargs)
  File "/map-vepfs/taoran/envs/taoran/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1583, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "/map-vepfs/taoran/envs/taoran/lib/python3.10/site-packages/wandb/sdk/interface/interface.py", line 771, in publish_output_raw
    self._publish_output_raw(o)
  File "/map-vepfs/taoran/envs/taoran/lib/python3.10/site-packages/wandb/sdk/interface/interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "/map-vepfs/taoran/envs/taoran/lib/python3.10/site-packages/wandb/sdk/interface/interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "/map-vepfs/taoran/envs/taoran/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 166, in send_record_publish
    self.send_server_request(server_req)
  File "/map-vepfs/taoran/envs/taoran/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 146, in send_server_request
    self._send_message(msg)
  File "/map-vepfs/taoran/envs/taoran/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 143, in _send_message
    self._sendall_with_error_handle(header + data)
  File "/map-vepfs/taoran/envs/taoran/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 122, in _sendall_with_error_handle
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe
