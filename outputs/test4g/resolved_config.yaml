experiment:
  name: test4g
  seed: 1234
  notes: Planner GRPO with 4 GPUs
paths:
  dataset_train: /map-vepfs/taoran/graph_planner/datasets/swebench/test.jsonl
  dataset_val: datasets/r2e_gym/val.jsonl
  planner_model: models/qwen3-14b
  planner_tokenizer: null
  cgm_model: /map-vepfs/taoran/CodeFuse-CGM/infra_model
  cgm_tokenizer: null
backends:
  planner_backend: local
  cgm_backend: local
  dtype: bfloat16
  device_map_planner:
  - 4
  - 5
  device_map_cgm:
  - 6
  - 7
  max_gpu_memory: null
planner_sampling:
  temperature: 0.2
  top_p: 0.95
  top_k: 50
  max_new_tokens: 512
  repetition_penalty: 1.0
  do_sample: false
  stop_on_invalid_json: true
  stop: []
  stop_ids: []
  max_input_tokens: 4096
cgm_generation:
  temperature: 0.2
  top_p: 0.9
  top_k: 40
  max_new_tokens: 1024
  num_return_sequences: 1
  do_sample: false
training:
  total_epochs: 1
  train_batch_size: 4
  grad_accum_steps: 8
  precision: bf16
  lr: 3.0e-05
  weight_decay: 0.01
  warmup_steps: 200
  gradient_checkpointing: true
  clip_grad_norm: 1.0
  kl_coef: 0.1
  entropy_coef: 0.01
  value_coef: 1.0
  clip_coef: 0.2
  target_kl: 0.15
  total_steps: null
  resume_from: null
env:
  max_steps: 6
  reward_scale: 1.0
  failure_penalty: -1.0
  step_penalty: -0.05
  timeout_penalty: -0.5
  repo_op_limit: 64
  disable_cgm_synthesis: false
  apply_patches: true
  docker_manifest: /map-vepfs/taoran/graph_planner/datasets/swebench/docker_images_validation.txt
  prepull_containers: false
  prepull_max_workers: null
  prepull_retries: null
  prepull_delay: null
  prepull_timeout: null
parallel:
  tensor_parallel_planner: 2
  tensor_parallel_cgm: 2
  replicas: 1
  parallel_agents: 2
  rollout_workers: 2
  workflow_parallel: 2
resources:
  num_gpus: 4
  num_nodes: 1
  ray_num_gpus: 4
  ray_num_cpus: 16
  ray_memory: null
  ray_object_store_memory: null
logging:
  wandb:
    enabled: true
    offline: false
    project: graph-planner
    entity: null
    run_name: test4g
    watch:
      enabled: true
      log: gradients
      log_freq: 200
  log_backend: wandb
  output_dir: outputs
  save_interval: 500
  eval_interval: 500
  resolved_run_dir: /map-vepfs/taoran/graph_planner/outputs/test4g
  resolved_config_path: /map-vepfs/taoran/graph_planner/outputs/test4g/resolved_config.yaml
telemetry:
  log_gpu: true
  log_ray: true
  log_patch_stats: true
  log_planner_parse_errors: true
  log_cgm_errors: true
verl_overrides:
  trainer:
    n_gpus_per_node: 4
    gradient_accumulation_steps: 4
